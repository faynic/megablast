const express = require('express');
const cors = require('cors');
const bodyParser = require('body-parser');
const mongoose = require('mongoose');
const bearerToken = require('express-bearer-token');
const oktaAuth = require('./auth');
const mbData = require('./mb-data');

const port = process.env.PORT || 8080;

const app = express()
	.use(cors())
	.use(bodyParser.json())
	.use(bearerToken())
	.use(oktaAuth)
	.use(mbData());

mongoose.connect('mongodb://localhost:27017/mb-data')
.then(() => {
	console.log('Connected to database');
	app.listen(port, () => {
		console.log('Express Server listening on port ${port}');
	});
});